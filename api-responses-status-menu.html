<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../polymer/lib/elements/dom-repeat.html">
<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="../paper-listbox/paper-listbox.html">
<dom-module id="api-responses-status-menu">
  <template>
    <style>
    :host {
      display: block;
      @apply --api-responses-status-menu;
    }

    [hidden] {
      display: none !important;
    }

    paper-item {
      cursor: pointer;
    }

    paper-item.iron-selected {
      font-weight: 500;
    }

    .green {
      color: var(--arc-status-code-color-200, rgba(56, 142, 60, 1));
    }

    .green.iron-selected:not([focused])  {
      background-color: var(--arc-status-code-bgcolor-200, rgba(56, 142, 60, 0.12));
    }

    .blue {
      color: var(--arc-status-code-color-300, rgba(48, 63, 159, 1));
    }

    .blue.iron-selected:not([focused])  {
      background-color: var(--arc-status-code-bgcolor-300, rgba(48, 63, 159, 0.12));
    }

    .orange {
      color: var(--arc-status-code-color-400, rgba(245, 124, 0, 1));
    }

    .orange.iron-selected:not([focused]) {
      background-color: var(--arc-status-code-bgcolor-400, rgba(245, 124, 0, 0.12));
    }

    .red {
      color: var(--arc-status-code-color-500, rgba(211, 47, 47, 1));
    }

    .red.iron-selected:not([focused])  {
      background-color: var(--arc-status-code-bgcolor-500, rgba(211, 47, 47, 0.12));
    }
    </style>
    <paper-listbox selected="{{selected}}">
      <template is="dom-repeat" items="[[codes]]">
        <paper-item class$="[[_computeCodeClass(item)]]">[[item]]</paper-item>
      </template>
    </paper-listbox>
  </template>
  <script>
  /**
   * `api-responses-status-menu`
   *
   * An element that renders list of status codes as a list options.
   *
   * ## Styling
   *
   * `<api-responses-status-menu>` provides the following custom properties and mixins for styling:
   *
   * Custom property | Description | Default
   * ----------------|-------------|----------
   * `--api-responses-status-menu` | Mixin applied to this elment | `{}`
   * `--arc-status-code-color-200` | Color of the 200 status code (ARC theme option) | `rgba(56, 142, 60, 1)` |
   * `--arc-status-code-color-300` | Color of the 300 status code (ARC theme option) | `rgba(48, 63, 159, 1)` |
   * `--arc-status-code-color-400` | Color of the 400 status code (ARC theme option) | `rgba(245, 124, 0, 1)` |
   * `--arc-status-code-color-500` | Color of the 500 status code (ARC theme option) | `rgba(211, 47, 47, 1)` |
   * `--arc-status-code-bgcolor-200` | Background color of the 200 status code | `rgba(56, 142, 60, 0.12)` |
   * `--arc-status-code-bgcolor-300` | Background color of the 300 status code | `rgba(48, 63, 159, 0.12)` |
   * `--arc-status-code-bgcolor-400` | Background color of the 400 status code | `rgba(245, 124, 0, 0.12)` |
   * `--arc-status-code-bgcolor-500` | Background color of the 500 status code | `rgba(211, 47, 47, 0.12)` |
   *
   * @customElement
   * @polymer
   * @demo demo/index.html
   * @memberof ApiElements
   */
  class ApiResponsesStatusMenu extends Polymer.Element {
    static get is() { return 'api-responses-status-menu'; }
    static get properties() {
      return {
        /**
         * List of status codes to render.
         *
         * Example:
         * ```javascript
         * [200, 204, 400, 401, 404]
         * ```
         *
         * @type {Array<String|Number>}
         */
        codes: {
          type: Array,
          observer: '_codesChanged'
        },
        /**
         * Currently selected index in `codes` array.
         * Note that this value is re-set to `0` when codes changes.
         */
        selected: {
          type: Number,
          notify: true
        }
      };
    }
    /**
     * Sets `selected` 0 when codes changes.
     * It only sets selection if there's actually a value to render.
     * It prohibits from performing additional computations for nothing.
     *
     * @param {?Array} codes
     */
    _codesChanged(codes) {
      if (codes && codes.length) {
        this.selected = 0;
      }
    }
    /**
     * Computes class name for the code display depending on range.
     *
     * @param {String|Number} code Status code
     * @return {?String} Color associated with the code.
     */
    _computeCodeClass(code) {
      code = Number(code);
      if (code !== code) {
        return '';
      }
      if (code >= 200 && code < 300) {
        return 'green';
      }
      if (code >= 300 && code < 400) {
        return 'blue';
      }
      if (code >= 400 && code < 500) {
        return 'orange';
      }
      if (code >= 500 && code < 600) {
        return 'red';
      }
    }
  }
  window.customElements.define(ApiResponsesStatusMenu.is, ApiResponsesStatusMenu);
  </script>
</dom-module>
